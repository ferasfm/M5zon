-- ===================================
-- ุณูุฑูุจุช ูุญุต ุดุงูู ููุธุงู ุงูุญุฒู
-- ===================================
-- ุงูุณุฎ ูุงูุตู ูุฐุง ุงูููุฏ ูู Supabase SQL Editor
-- ุซู ุงุถุบุท Run (F5)
-- ===================================

-- 1๏ธโฃ ุงูุชุญูู ูู ูุฌูุฏ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ
-- ===================================
SELECT 
    'โ ูุญุต ุงูุฃุนูุฏุฉ' as "ุงูุงุฎุชุจุงุฑ",
    column_name as "ุงุณู ุงูุนููุฏ",
    data_type as "ุงูููุน",
    is_nullable as "ุงุฎุชูุงุฑู"
FROM information_schema.columns
WHERE table_name = 'inventory_items'
AND column_name IN ('bundle_group_id', 'bundle_name')
ORDER BY column_name;

-- ุงููุชูุฌุฉ ุงููุชููุนุฉ: ุตููู (bundle_group_id ู bundle_name)
-- ุฅุฐุง ูู ูุธูุฑ ุดูุก โ ูุฌุจ ุชุดุบูู add_bundle_tracking.sql

-- ===================================
-- 2๏ธโฃ ุฅุญุตุงุฆูุงุช ุงูุจูุงูุงุช
-- ===================================
SELECT 
    '๐ ุฅุญุตุงุฆูุงุช ุงูุจูุงูุงุช' as "ุงูุงุฎุชุจุงุฑ",
    CASE 
        WHEN bundle_group_id IS NULL THEN '๐ต ููุชุฌุงุช ุนุงุฏูุฉ/ูุฏููุฉ'
        ELSE '๐ข ุญุฒู ุฌุฏูุฏุฉ'
    END as "ุงูููุน",
    COUNT(*) as "ุงูุนุฏุฏ"
FROM inventory_items
GROUP BY 
    CASE 
        WHEN bundle_group_id IS NULL THEN '๐ต ููุชุฌุงุช ุนุงุฏูุฉ/ูุฏููุฉ'
        ELSE '๐ข ุญุฒู ุฌุฏูุฏุฉ'
    END;

-- ุงููุชูุฌุฉ ุงููุชููุนุฉ:
-- ๐ต ููุชุฌุงุช ุนุงุฏูุฉ/ูุฏููุฉ: [ุนุฏุฏ ุงููุทุน ุงููุฏููุฉ]
-- ๐ข ุญุฒู ุฌุฏูุฏุฉ: [ุนุฏุฏ ุงููุทุน ูู ุงูุญุฒู ุงูุฌุฏูุฏุฉ]

-- ===================================
-- 3๏ธโฃ ุนุฑุถ ุงูุญุฒู ุงูููุฌูุฏุฉ
-- ===================================
SELECT 
    '๐ฆ ุงูุญุฒู ุงูููุฌูุฏุฉ' as "ุงูุงุฎุชุจุงุฑ",
    bundle_group_id as "ูุนุฑู ุงูุญุฒูุฉ",
    bundle_name as "ุงุณู ุงูุญุฒูุฉ",
    COUNT(*) as "ุนุฏุฏ ุงููุทุน",
    SUM(cost_price) as "ุงูุชูููุฉ ุงูุฅุฌูุงููุฉ",
    TO_CHAR(MIN(purchase_date), 'YYYY-MM-DD') as "ุชุงุฑูุฎ ุงูุงุณุชูุงู"
FROM inventory_items
WHERE bundle_group_id IS NOT NULL
GROUP BY bundle_group_id, bundle_name
ORDER BY MIN(purchase_date) DESC;

-- ุงููุชูุฌุฉ ุงููุชููุนุฉ:
-- ุฅุฐุง ูู ุชุณุชูู ุญุฒู ุจุนุฏ โ ูุง ุชูุฌุฏ ูุชุงุฆุฌ (ุทุจูุนู)
-- ุฅุฐุง ุงุณุชููุช ุญุฒู โ ุณุชุธูุฑ ููุง

-- ===================================
-- 4๏ธโฃ ุขุฎุฑ 10 ูุทุน ูุณุชููุฉ
-- ===================================
SELECT 
    '๐ ุขุฎุฑ ุงููุทุน ุงููุณุชููุฉ' as "ุงูุงุฎุชุจุงุฑ",
    serial_number as "ุจุงุฑ ููุฏ",
    CASE 
        WHEN bundle_group_id IS NOT NULL THEN 'โ ุญุฒูุฉ: ' || bundle_name
        ELSE 'โช ููุชุฌ ุนุงุฏู'
    END as "ุงูููุน",
    cost_price as "ุงูุชูููุฉ",
    TO_CHAR(purchase_date, 'YYYY-MM-DD HH24:MI') as "ุชุงุฑูุฎ ุงูุงุณุชูุงู"
FROM inventory_items
ORDER BY purchase_date DESC
LIMIT 10;

-- ุงููุชูุฌุฉ ุงููุชููุนุฉ:
-- โ ุญุฒูุฉ: [ุงุณู ุงูุญุฒูุฉ] โ ูููุทุน ุงูุฌุฏูุฏุฉ ุงููุณุชููุฉ ูุญุฒูุฉ
-- โช ููุชุฌ ุนุงุฏู โ ูููุทุน ุงูุนุงุฏูุฉ ุฃู ุงููุฏููุฉ

-- ===================================
-- 5๏ธโฃ ูุญุต ุงูููุฑุณ (Index)
-- ===================================
SELECT 
    '๐ ูุญุต ุงูููุฑุณ' as "ุงูุงุฎุชุจุงุฑ",
    indexname as "ุงุณู ุงูููุฑุณ",
    tablename as "ุงูุฌุฏูู"
FROM pg_indexes
WHERE tablename = 'inventory_items'
AND indexname = 'idx_inventory_items_bundle_group';

-- ุงููุชูุฌุฉ ุงููุชููุนุฉ: ุตู ูุงุญุฏ ูุญุชูู ุนูู ุงุณู ุงูููุฑุณ
-- ุฅุฐุง ูู ูุธูุฑ โ ุงูููุฑุณ ุบูุฑ ููุฌูุฏ (ููู ููุณ ุถุฑูุฑู ููุนูู)

-- ===================================
-- ๐ ุชูุณูุฑ ุงููุชุงุฆุฌ
-- ===================================

/*
โ ุฅุฐุง ุธูุฑุช ุงูุฃุนูุฏุฉ ูู ุงูุงุฎุชุจุงุฑ 1:
   โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุญุฏุซุฉ ุจูุฌุงุญ!

๐ ุงูุงุฎุชุจุงุฑ 2 ููุถุญ:
   โ ุนุฏุฏ ุงูููุชุฌุงุช ุงูุนุงุฏูุฉ/ุงููุฏููุฉ
   โ ุนุฏุฏ ุงููุทุน ูู ุงูุญุฒู ุงูุฌุฏูุฏุฉ

๐ฆ ุงูุงุฎุชุจุงุฑ 3 ูุนุฑุถ:
   โ ุฌููุน ุงูุญุฒู ุงููุณุชููุฉ ุจุนุฏ ุงูุชุญุฏูุซ
   โ ุฅุฐุง ูุงู ูุงุฑุบ = ูู ุชุณุชูู ุญุฒู ุจุนุฏ (ุทุจูุนู)

๐ ุงูุงุฎุชุจุงุฑ 4 ููุถุญ:
   โ ุขุฎุฑ ุงููุทุน ุงููุณุชููุฉ
   โ ูู ูู ุญุฒู ุฃู ููุชุฌุงุช ุนุงุฏูุฉ

๐ ุงูุงุฎุชุจุงุฑ 5 ูุชุญูู:
   โ ูู ูุฌูุฏ ุงูููุฑุณ ููุฃุฏุงุก
   โ ููุณ ุถุฑูุฑู ููุนูู ููู ูุญุณู ุงูุฃุฏุงุก
*/

-- ===================================
-- โ ุงูุฎุทูุงุช ุงูุชุงููุฉ
-- ===================================

/*
1. ุฅุฐุง ูู ุชุธูุฑ ุงูุฃุนูุฏุฉ:
   โ ุดุบูู ููู: add_bundle_tracking.sql

2. ุฅุฐุง ุธูุฑุช ุงูุฃุนูุฏุฉ ููู ูุง ุชูุฌุฏ ุญุฒู:
   โ ุทุจูุนู! ุงุณุชูู ุญุฒูุฉ ุฌุฏูุฏุฉ ูู ุงูุจุฑูุงูุฌ

3. ุฅุฐุง ุงูุจูุงูุงุช ุงููุฏููุฉ ุชุธูุฑ ูููุฑุฏุฉ:
   โ ุทุจูุนู! ุฑุงุฌุน: DATA_MIGRATION_REPORT.md

4. ูุงุฎุชุจุงุฑ ุงููุธุงู:
   โ ุงุณุชูู ุญุฒูุฉ ุฌุฏูุฏุฉ ูู ุงูุจุฑูุงูุฌ
   โ ุฃูุดุฆ ูุทุงูุจุฉ ูุงููุฉ
   โ ูุฌุจ ุฃู ุชุธูุฑ ุงูุญุฒูุฉ ูุณุทุฑ ูุงุญุฏ
*/

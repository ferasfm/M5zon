# ๐ ุชูุฑูุฑ ุดุงูู: ุงูุจูุงูุงุช ุงููุฏููุฉ ูุงูุญุฒู

## ๐ **ุงูุชุดุฎูุต**

### **ุงููุดููุฉ:**
ุงูุญุฒู ุงููุณุชููุฉ **ูุจู** ุงูุชุญุฏูุซ ุชุธูุฑ ูููุชุฌุงุช ูููุฑุฏุฉ ูู ุงููุทุงูุจุฉ ุงููุงููุฉ.

### **ุงูุณุจุจ:**
```
ุงูุจูุงูุงุช ุงููุฏููุฉ:
โโโ bundle_group_id = NULL  โ
โโโ bundle_name = NULL      โ
โโโ ุงููุชูุฌุฉ: ุชุธูุฑ ูููุชุฌุงุช ูููุฑุฏุฉ
```

### **ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ (ุจุนุฏ ุงูุชุญุฏูุซ):**
```
ุงูุญุฒู ุงูุฌุฏูุฏุฉ:
โโโ bundle_group_id = "bundle_123..."  โ
โโโ bundle_name = "ุญุฒูุฉ ุงููุฑุงูุจุฉ"     โ
โโโ ุงููุชูุฌุฉ: ุชุธูุฑ ูุญุฒูุฉ ูุงุญุฏุฉ
```

---

## โ **ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**

### **ุงูุฎุทูุฉ 1: ุชุญูู ูู ูุฌูุฏ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ**

ุงูุชุญ Supabase Dashboard โ SQL Editor โ ุดุบูู:

```sql
-- ุงูุชุญูู ูู ูุฌูุฏ ุงูุฃุนูุฏุฉ
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_name = 'inventory_items'
AND column_name IN ('bundle_group_id', 'bundle_name')
ORDER BY column_name;
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```
column_name      | data_type | is_nullable
-----------------|-----------|------------
bundle_group_id  | text      | YES
bundle_name      | text      | YES
```

โ ุฅุฐุง ุธูุฑุช ุงููุชูุฌุฉ โ ุงูุฃุนูุฏุฉ ููุฌูุฏุฉ
โ ุฅุฐุง ูู ุชุธูุฑ โ ูุฌุจ ุชุดุบูู SQL migration

---

### **ุงูุฎุทูุฉ 2: ุชุญูู ูู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ**

```sql
-- ุนุฑุถ ุนููุฉ ูู ุงูุจูุงูุงุช
SELECT 
    id,
    serial_number,
    bundle_group_id,
    bundle_name,
    purchase_date
FROM inventory_items
ORDER BY purchase_date DESC
LIMIT 10;
```

**ูุง ุชุจุญุซ ุนูู:**
- ุงููุทุน ุงููุฏููุฉ: `bundle_group_id = NULL`
- ุงููุทุน ุงูุฌุฏูุฏุฉ (ุจุนุฏ ุงูุชุญุฏูุซ): `bundle_group_id = "bundle_..."`

---

### **ุงูุฎุทูุฉ 3: ุฅุญุตุงุฆูุงุช ุงูุจูุงูุงุช**

```sql
-- ุนุฏุฏ ุงููุทุน ุญุณุจ ููุนูุง
SELECT 
    CASE 
        WHEN bundle_group_id IS NULL THEN 'ููุชุฌุงุช ุนุงุฏูุฉ/ูุฏููุฉ'
        ELSE 'ุญุฒู ุฌุฏูุฏุฉ'
    END as type,
    COUNT(*) as count
FROM inventory_items
GROUP BY type;
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```
type                    | count
------------------------|-------
ููุชุฌุงุช ุนุงุฏูุฉ/ูุฏููุฉ     | 150   (ูุซุงู)
ุญุฒู ุฌุฏูุฏุฉ              | 0     (ุฅุฐุง ูู ุชุณุชูู ุญุฒู ุจุนุฏ)
```

---

## ๐ง **ุงูุญููู ุงููุชุงุญุฉ**

### **ุงูุญู 1: ุชุฑู ุงูุจูุงูุงุช ุงููุฏููุฉ ููุง ูู (ููุตู ุจู)** โญ

**ุงููููุฒุงุช:**
- โ ุขูู ุชูุงูุงู
- โ ูุง ูุบูุฑ ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ
- โ ุงูุญุฒู ุงูุฌุฏูุฏุฉ ุณุชุนูู ุจุดูู ุตุญูุญ

**ุงูุนููุจ:**
- โ๏ธ ุงูุญุฒู ุงููุฏููุฉ ุชุธูุฑ ูููุชุฌุงุช ูููุฑุฏุฉ

**ูุชู ุชุณุชุฎุฏูู:**
- ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุงููุฏููุฉ ููููุฉ
- ุฅุฐุง ููุช ูุง ุชุฑูุฏ ุชุนุฏูู ุงูุณุฌูุงุช ุงูุชุงุฑูุฎูุฉ

---

### **ุงูุญู 2: ุชุญุฏูุซ ุงูุจูุงูุงุช ุงููุฏููุฉ ูุฏููุงู** ๐ง

ุฅุฐุง ููุช ุชุนุฑู ุฃู ุงููุทุน ุชูุชูู ูุฃู ุญุฒูุฉุ ููููู ุชุญุฏูุซูุง:

```sql
-- ูุซุงู: ุชุญุฏูุซ 3 ูุทุน ูุชููู ุญุฒูุฉ ูุงุญุฏุฉ
UPDATE inventory_items
SET 
    bundle_group_id = 'bundle_old_001',
    bundle_name = 'ุญุฒูุฉ ุงููุฑุงูุจุฉ ุงููุฏููุฉ'
WHERE serial_number IN ('SERIAL001', 'SERIAL002', 'SERIAL003');
```

**ุฎุทูุงุช ุงูุชูููุฐ:**
1. ุญุฏุฏ ุงููุทุน ุงูุชู ุชูุชูู ูููุณ ุงูุญุฒูุฉ
2. ุงุฎุชุฑ `bundle_group_id` ูุฑูุฏ ููู ุญุฒูุฉ
3. ุดุบูู UPDATE ููู ุญุฒูุฉ

**ูุซุงู ุนููู:**
```sql
-- ุญุฒูุฉ 1: ูุงููุฑุงุช + DVR
UPDATE inventory_items
SET 
    bundle_group_id = 'bundle_old_001',
    bundle_name = 'ุญุฒูุฉ ูุฑุงูุจุฉ - ูููุน A'
WHERE id IN ('id1', 'id2', 'id3');

-- ุญุฒูุฉ 2: ูุงููุฑุงุช ุฃุฎุฑู
UPDATE inventory_items
SET 
    bundle_group_id = 'bundle_old_002',
    bundle_name = 'ุญุฒูุฉ ูุฑุงูุจุฉ - ูููุน B'
WHERE id IN ('id4', 'id5', 'id6');
```

---

### **ุงูุญู 3: ุณูุฑูุจุช ุชููุงุฆู (ูุชูุฏู)** ๐ค

ุฅุฐุง ูุงูุช ุงูุญุฒู ุงููุฏููุฉ ุชุชุจุน ููุท ูุนูู (ููุณ ุงูุชุงุฑูุฎุ ููุณ ุงูููุฑุฏุ ููุณ ุงูุนููู):

```sql
-- ุชุฌููุน ุชููุงุฆู ุญุณุจ ุงูุชุงุฑูุฎ ูุงูููุฑุฏ ูุงูุนููู
WITH bundles AS (
    SELECT 
        purchase_date,
        supplier_id,
        destination_client_id,
        'bundle_auto_' || MD5(
            COALESCE(purchase_date::text, '') || 
            COALESCE(supplier_id, '') || 
            COALESCE(destination_client_id, '')
        ) as bundle_id
    FROM inventory_items
    WHERE bundle_group_id IS NULL
    AND purchase_date > '2024-01-01'  -- ููุท ุงูุจูุงูุงุช ุงูุญุฏูุซุฉ
    GROUP BY purchase_date, supplier_id, destination_client_id
    HAVING COUNT(*) > 1  -- ููุท ุงููุฌููุนุงุช ุงูุชู ูููุง ุฃูุซุฑ ูู ูุทุนุฉ
)
UPDATE inventory_items i
SET 
    bundle_group_id = b.bundle_id,
    bundle_name = 'ุญุฒูุฉ ุชููุงุฆูุฉ - ' || TO_CHAR(i.purchase_date, 'YYYY-MM-DD')
FROM bundles b
WHERE i.purchase_date = b.purchase_date
AND COALESCE(i.supplier_id, '') = COALESCE(b.supplier_id, '')
AND COALESCE(i.destination_client_id, '') = COALESCE(b.destination_client_id, '')
AND i.bundle_group_id IS NULL;
```

โ๏ธ **ุชุญุฐูุฑ:** ุงุฎุชุจุฑ ุนูู ุจูุงูุงุช ุชุฌุฑูุจูุฉ ุฃููุงู!

---

## ๐ **ุฎุทุฉ ุงูุนูู ุงูููุตู ุจูุง**

### **ููุจูุงูุงุช ุงูุฌุฏูุฏุฉ (ูู ุงูุขู ูุตุงุนุฏุงู):**
โ **ุฌุงูุฒุฉ!** ุงุณุชุฎุฏู ุชุจููุจ "ุงุณุชูุงู ุญุฒูุฉ" ูุณุชุนูู ุชููุงุฆูุงู

### **ููุจูุงูุงุช ุงููุฏููุฉ:**

#### **ุงูุฎูุงุฑ A: ูุง ุชูุนู ุดูุก** (ููุตู ุจู)
- ุงูุจูุงูุงุช ุงููุฏููุฉ ุชุจูู ููุง ูู
- ุงูุญุฒู ุงูุฌุฏูุฏุฉ ููุท ุณุชุธูุฑ ุจุดูู ุตุญูุญ
- ุขูู ูุจุณูุท

#### **ุงูุฎูุงุฑ B: ุชุญุฏูุซ ูุฏูู**
1. ุญุฏุฏ ุงูุญุฒู ุงููุฏููุฉ
2. ุงุณุชุฎุฏู UPDATE SQL ููู ุญุฒูุฉ
3. ุงุฎุชุจุฑ ุงููุทุงูุจุฉ ุงููุงููุฉ

#### **ุงูุฎูุงุฑ C: ุชุฌุงูู ุงููุฏูู**
- ุฑูุฒ ุนูู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
- ุงูุจูุงูุงุช ุงููุฏููุฉ ููุฃุฑุดูู ููุท

---

## ๐งช **ุงุฎุชุจุงุฑ ุงููุธุงู**

### **ุงุฎุชุจุงุฑ 1: ุงุณุชูุงู ุญุฒูุฉ ุฌุฏูุฏุฉ**

1. ุงุฐูุจ ุฅูู "ุงุณุชูุงู ุจุถุงุนุฉ"
2. ุงุฎุชุฑ ุชุจููุจ "ุงุณุชูุงู ุญุฒูุฉ"
3. ุงุฎุชุฑ ุญุฒูุฉ ูุงุณุชูููุง
4. ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```sql
-- ุนุฑุถ ุขุฎุฑ ุญุฒูุฉ ูุณุชููุฉ
SELECT 
    serial_number,
    bundle_group_id,
    bundle_name,
    purchase_date
FROM inventory_items
WHERE bundle_group_id IS NOT NULL
ORDER BY purchase_date DESC
LIMIT 5;
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุฌููุน ุงููุทุน ููุง ููุณ `bundle_group_id`
- ุฌููุน ุงููุทุน ููุง ููุณ `bundle_name`

---

### **ุงุฎุชุจุงุฑ 2: ุงููุทุงูุจุฉ ุงููุงููุฉ**

1. ุงุฐูุจ ุฅูู "ูุทุงูุจุงุช ูุงููุฉ"
2. ุงุฎุชุฑ ุงูููุฑุฏ ูุงููุชุฑุฉ
3. ุฃูุดุฆ ุงูุชูุฑูุฑ
4. ุชุญูู ูู ุงููุชูุฌุฉ:

**ููุญุฒู ุงูุฌุฏูุฏุฉ:**
```
ุงูููุชุฌ                    | ุงููููุฉ | ุงูุณุนุฑ
-------------------------|--------|-------
ุญุฒูุฉ ุงููุฑุงูุจุฉ ุงููุงููุฉ    | 1      | 1500  โ
```

**ููููุชุฌุงุช ุงููุฏููุฉ:**
```
ุงูููุชุฌ              | ุงููููุฉ | ุงูุณุนุฑ
-------------------|--------|-------
ูุงููุฑุง ูุฑุงูุจุฉ      | 2      | 500   (ุทุจูุนู)
DVR 8 ูููุงุช        | 1      | 800   (ุทุจูุนู)
```

---

## ๐ **ุณูุฑูุจุช ูุญุต ุดุงูู**

ุงูุณุฎ ูุงูุตู ูุฐุง ูู Supabase SQL Editor:

```sql
-- ===================================
-- ูุญุต ุดุงูู ููุธุงู ุงูุญุฒู
-- ===================================

-- 1. ุงูุชุญูู ูู ูุฌูุฏ ุงูุฃุนูุฏุฉ
SELECT 
    '1. ูุญุต ุงูุฃุนูุฏุฉ' as test,
    CASE 
        WHEN COUNT(*) = 2 THEN 'โ ุงูุฃุนูุฏุฉ ููุฌูุฏุฉ'
        ELSE 'โ ุงูุฃุนูุฏุฉ ููููุฏุฉ'
    END as result
FROM information_schema.columns
WHERE table_name = 'inventory_items'
AND column_name IN ('bundle_group_id', 'bundle_name');

-- 2. ุฅุญุตุงุฆูุงุช ุงูุจูุงูุงุช
SELECT 
    '2. ุฅุญุตุงุฆูุงุช ุงูุจูุงูุงุช' as test,
    CASE 
        WHEN bundle_group_id IS NULL THEN 'ููุชุฌุงุช ุนุงุฏูุฉ/ูุฏููุฉ'
        ELSE 'ุญุฒู ุฌุฏูุฏุฉ'
    END as type,
    COUNT(*) as count
FROM inventory_items
GROUP BY type;

-- 3. ุนุฑุถ ุงูุญุฒู ุงูููุฌูุฏุฉ
SELECT 
    '3. ุงูุญุฒู ุงูููุฌูุฏุฉ' as test,
    bundle_group_id,
    bundle_name,
    COUNT(*) as items_count,
    SUM(cost_price) as total_cost,
    MIN(purchase_date) as purchase_date
FROM inventory_items
WHERE bundle_group_id IS NOT NULL
GROUP BY bundle_group_id, bundle_name
ORDER BY purchase_date DESC;

-- 4. ุนุฑุถ ุขุฎุฑ 5 ูุทุน ูุณุชููุฉ
SELECT 
    '4. ุขุฎุฑ ุงููุทุน ุงููุณุชููุฉ' as test,
    serial_number,
    bundle_group_id,
    bundle_name,
    cost_price,
    purchase_date
FROM inventory_items
ORDER BY purchase_date DESC
LIMIT 5;
```

---

## โ **ุงูุฎูุงุตุฉ**

### **ุงููุถุน ุงูุญุงูู:**
- โ ุงูููุฏ ุตุญูุญ ููุนูู
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ (ุฅุฐุง ุดุบูุช SQL)
- โ๏ธ ุงูุจูุงูุงุช ุงููุฏููุฉ ููุณ ููุง `bundle_group_id`

### **ูุง ูุนูู:**
- โ ุงูุญุฒู ุงูุฌุฏูุฏุฉ (ุจุนุฏ ุงูุชุญุฏูุซ)
- โ ุงูููุชุฌุงุช ุงูุนุงุฏูุฉ (ุงูุฌุฏูุฏุฉ ูุงููุฏููุฉ)

### **ูุง ูุง ูุนูู:**
- โ ุงูุญุฒู ุงููุฏููุฉ (ูุจู ุงูุชุญุฏูุซ) - ุชุธูุฑ ูููุชุฌุงุช ูููุฑุฏุฉ

### **ุงูุญู:**
- **ูููุณุชูุจู:** ุงุณุชุฎุฏู "ุงุณุชูุงู ุญุฒูุฉ" โ
- **ูููุงุถู:** ุงุฎุชุฑ ุฃุญุฏ ุงูุญููู ุงูุซูุงุซุฉ ุฃุนูุงู

---

## ๐ฏ **ุงูุชูุตูุฉ ุงูููุงุฆูุฉ**

### **ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุงููุฏููุฉ ููููุฉ:**
โ **ุงุชุฑููุง ููุง ูู** ูุงุณุชุฎุฏู ุงููุธุงู ุงูุฌุฏูุฏ ููุญุฒู ุงูุฌุฏูุฏุฉ

### **ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุงููุฏููุฉ ูููุฉ:**
โ **ุญุฏุซูุง ูุฏููุงู** ุจุงุณุชุฎุฏุงู UPDATE SQL

### **ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ูุซูุฑุฉ ูููุธูุฉ:**
โ **ุงุณุชุฎุฏู ุงูุณูุฑูุจุช ุงูุชููุงุฆู** (ุจุญุฐุฑ!)

---

**ูู ุชุฑูุฏ ูุณุงุนุฏุฉ ูู ุชุญุฏูุซ ุงูุจูุงูุงุช ุงููุฏููุฉุ** ๐ค
